<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WWF Terrestrial Realms - MapLibre GL Test</title>
    <script src='https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.js'></script>
    <link href='https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css' rel='stylesheet' />
    <style>
        body { margin: 0; padding: 0; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%; }
        .info-panel {
            position: absolute;
            top: 10px;
            left: 10px;
            background: white;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 300px;
            z-index: 1000;
        }
        .info-panel h3 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .info-panel p {
            margin: 5px 0;
            font-size: 14px;
        }
        .legend {
            margin-top: 15px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            border: 1px solid #ccc;
        }
        .legend-text {
            font-size: 12px;
        }
        .file-selector {
            margin-bottom: 15px;
        }
        .file-selector select {
            width: 100%;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    
    <div class="info-panel">
        <h3>WWF Terrestrial Realms</h3>
        <div class="file-selector">
            <label for="fileSelect">Select GeoJSON file:</label>
            <select id="fileSelect">
                <option value="realms_web_final.geojson">realms_web_final.geojson (1.67 MB)</option>
                <option value="realms_web.geojson">realms_web.geojson (3.29 MB)</option>
                <option value="realms_full.geojson">realms_full.geojson (72.21 MB)</option>
            </select>
        </div>
        
        <p><strong>Instructions:</strong></p>
        <p>• Pan and zoom to explore the realms</p>
        <p>• Click on a realm to see details</p>
        <p>• Switch between files to compare performance</p>
        
        <div class="legend">
            <p><strong>Realm Colors:</strong></p>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #FF6B6B;"></div>
                <div class="legend-text">Afrotropical</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #4ECDC4;"></div>
                <div class="legend-text">Australasia</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #45B7D1;"></div>
                <div class="legend-text">Indomalayan</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #96CEB4;"></div>
                <div class="legend-text">Nearctic</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #FFEAA7;"></div>
                <div class="legend-text">Neotropical</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #DDA0DD;"></div>
                <div class="legend-text">Oceania</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #98D8C8;"></div>
                <div class="legend-text">Palearctic</div>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #F7DC6F;"></div>
                <div class="legend-text">Antarctic</div>
            </div>
        </div>
    </div>

    <script>
        // Initialize the map
        const map = new maplibregl.Map({
            container: 'map',
            style: {
                version: 8,
                sources: {
                    'osm': {
                        type: 'raster',
                        tiles: ['https://tile.openstreetmap.org/{z}/{x}/{y}.png'],
                        tileSize: 256,
                        attribution: '© OpenStreetMap contributors'
                    }
                },
                layers: [{
                    id: 'osm',
                    type: 'raster',
                    source: 'osm',
                    minzoom: 0,
                    maxzoom: 22
                }]
            },
            center: [0, 0],
            zoom: 2
        });

        let currentSource = null;
        let currentLayer = null;

        // Function to load and display GeoJSON
        function loadGeoJSON(filename) {
            // Remove existing source and layer if they exist
            if (currentSource && currentLayer) {
                if (map.getLayer(currentLayer)) {
                    map.removeLayer(currentLayer);
                }
                if (map.getSource(currentSource)) {
                    map.removeSource(currentSource);
                }
            }

            // Add new source
            map.addSource('realms', {
                type: 'geojson',
                data: filename
            });

            // Add fill layer
            map.addLayer({
                id: 'realms-fill',
                type: 'fill',
                source: 'realms',
                paint: {
                    'fill-color': ['get', 'color'],
                    'fill-opacity': 0.7
                }
            });

            // Add outline layer
            map.addLayer({
                id: 'realms-outline',
                type: 'line',
                source: 'realms',
                paint: {
                    'line-color': '#000000',
                    'line-width': 1,
                    'line-opacity': 0.8
                }
            });

            currentSource = 'realms';
            currentLayer = 'realms-fill';

            // Add hover effects
            map.on('mouseenter', 'realms-fill', () => {
                map.getCanvas().style.cursor = 'pointer';
            });

            map.on('mouseleave', 'realms-fill', () => {
                map.getCanvas().style.cursor = '';
            });

            // Add click event
            map.on('click', 'realms-fill', (e) => {
                const realm = e.features[0].properties.realm_name;
                const code = e.features[0].properties.realm_code;
                alert(`Clicked on ${realm} realm (${code})`);
            });
        }

        // File selector change handler
        document.getElementById('fileSelect').addEventListener('change', (e) => {
            const filename = e.target.value;
            loadGeoJSON(filename);
        });

        // Load initial file when map is ready
        map.on('load', () => {
            loadGeoJSON('realms_web_final.geojson');
        });

        // Add navigation controls
        map.addControl(new maplibregl.NavigationControl());
        map.addControl(new maplibregl.FullscreenControl());
    </script>
</body>
</html>


